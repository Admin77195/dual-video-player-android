# åŒè§†é¢‘æ’­æ”¾å™¨ Androidç‰ˆ - è¯¦ç»†ç¼–è¯‘æŒ‡å—

## ğŸ¯ ç¼–è¯‘ç¯å¢ƒé€‰æ‹©

### æ–¹æ¡ˆ1ï¼šWSL2ï¼ˆæ¨èWindowsç”¨æˆ·ï¼‰

**ä¼˜ç‚¹**ï¼š
- åœ¨Windowsä¸Šç›´æ¥ä½¿ç”¨
- ä¸Windowsæ–‡ä»¶ç³»ç»Ÿäº’é€š
- æ€§èƒ½æ¥è¿‘åŸç”ŸLinux

**ç¼ºç‚¹**ï¼š
- é¦–æ¬¡é…ç½®ç¨å¤æ‚
- å ç”¨ä¸€å®šç£ç›˜ç©ºé—´

### æ–¹æ¡ˆ2ï¼šLinuxè™šæ‹Ÿæœº

**ä¼˜ç‚¹**ï¼š
- å®Œæ•´çš„Linuxç¯å¢ƒ
- éš”ç¦»æ€§å¥½

**ç¼ºç‚¹**ï¼š
- æ€§èƒ½æŸå¤±
- éœ€è¦é¢å¤–çš„è™šæ‹Ÿæœºè½¯ä»¶

### æ–¹æ¡ˆ3ï¼šåŸç”ŸLinux

**ä¼˜ç‚¹**ï¼š
- æ€§èƒ½æœ€ä½³
- æœ€ç¨³å®š

**ç¼ºç‚¹**ï¼š
- éœ€è¦Linuxç³»ç»Ÿ

---

## ğŸ“‹ æ–¹æ¡ˆ1ï¼šWSL2è¯¦ç»†æ­¥éª¤ï¼ˆæ¨èï¼‰

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…WSL2

#### 1.1 å¯ç”¨WSLåŠŸèƒ½

ä»¥**ç®¡ç†å‘˜èº«ä»½**è¿è¡ŒPowerShellï¼š

```powershell
# å¯ç”¨WSL
dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

# å¯ç”¨è™šæ‹Ÿæœºå¹³å°
dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart

# é‡å¯ç”µè„‘
Restart-Computer
```

#### 1.2 å®‰è£…WSL2

é‡å¯åï¼Œå†æ¬¡ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShellï¼š

```powershell
# è®¾ç½®WSL2ä¸ºé»˜è®¤ç‰ˆæœ¬
wsl --set-default-version 2

# å®‰è£…Ubuntu 22.04
wsl --install -d Ubuntu-22.04
```

#### 1.3 åˆå§‹åŒ–Ubuntu

å®‰è£…å®Œæˆåä¼šè‡ªåŠ¨æ‰“å¼€Ubuntuç»ˆç«¯ï¼š
- è®¾ç½®ç”¨æˆ·åï¼ˆä¾‹å¦‚ï¼šdeveloperï¼‰
- è®¾ç½®å¯†ç 

---

### ç¬¬äºŒæ­¥ï¼šé…ç½®ç¼–è¯‘ç¯å¢ƒ

#### 2.1 æ›´æ–°ç³»ç»Ÿ

```bash
# æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨
sudo apt update

# å‡çº§å·²å®‰è£…çš„è½¯ä»¶åŒ…
sudo apt upgrade -y
```

#### 2.2 å®‰è£…åŸºç¡€å·¥å…·

```bash
# å®‰è£…Pythonå’Œpip
sudo apt install -y python3 python3-pip python3-venv

# å®‰è£…Git
sudo apt install -y git

# å®‰è£…æ„å»ºå·¥å…·
sudo apt install -y build-essential
```

#### 2.3 å®‰è£…Buildozerä¾èµ–

```bash
# å®‰è£…Javaå¼€å‘å·¥å…·åŒ…
sudo apt install -y openjdk-17-jdk

# å®‰è£…ç¼–è¯‘å·¥å…·
sudo apt install -y autoconf libtool pkg-config

# å®‰è£…åº“æ–‡ä»¶
sudo apt install -y zlib1g-dev libncurses5-dev libncursesw5-dev libtinfo5 cmake libffi-dev libssl-dev

# å®‰è£…å‹ç¼©å·¥å…·
sudo apt install -y zip unzip
```

#### 2.4 å®‰è£…PythonåŒ…

```bash
# å‡çº§pip
pip3 install --upgrade pip

# å®‰è£…Cythonï¼ˆæŒ‡å®šç‰ˆæœ¬ï¼‰
pip3 install --upgrade cython==0.29.33

# å®‰è£…Buildozer
pip3 install buildozer

# éªŒè¯å®‰è£…
buildozer --version
```

---

### ç¬¬ä¸‰æ­¥ï¼šå‡†å¤‡é¡¹ç›®æ–‡ä»¶

#### 3.1 å¤åˆ¶é¡¹ç›®åˆ°WSL

```bash
# åˆ›å»ºå·¥ä½œç›®å½•
mkdir -p ~/projects
cd ~/projects

# ä»Windowså¤åˆ¶é¡¹ç›®
cp -r /mnt/d/åŒè§†é¢‘æ’­æ”¾å™¨_Android ./

# è¿›å…¥é¡¹ç›®ç›®å½•
cd åŒè§†é¢‘æ’­æ”¾å™¨_Android

# æŸ¥çœ‹æ–‡ä»¶
ls -la
```

**è¯´æ˜**ï¼š
- Windowsçš„Dç›˜åœ¨WSLä¸­è·¯å¾„ä¸º `/mnt/d/`
- Cç›˜ä¸º `/mnt/c/`

#### 3.2 éªŒè¯é¡¹ç›®æ–‡ä»¶

ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶å­˜åœ¨ï¼š
```bash
ls -l main.py buildozer.spec requirements.txt README.md
```

---

### ç¬¬å››æ­¥ï¼šé¦–æ¬¡ç¼–è¯‘

#### 4.1 åˆå§‹åŒ–Buildozer

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•
cd ~/projects/åŒè§†é¢‘æ’­æ”¾å™¨_Android

# åˆå§‹åŒ–ï¼ˆä¼šä¸‹è½½Android SDK/NDKï¼Œéœ€è¦æ—¶é—´ï¼‰
buildozer init
```

**æ³¨æ„**ï¼š
- é¦–æ¬¡è¿è¡Œä¼šä¸‹è½½çº¦2-3GBçš„æ–‡ä»¶
- éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥
- å¯èƒ½éœ€è¦30åˆ†é’Ÿåˆ°1å°æ—¶

#### 4.2 ç¼–è¯‘Debugç‰ˆæœ¬

```bash
# å¼€å§‹ç¼–è¯‘ï¼ˆè¯¦ç»†è¾“å‡ºï¼‰
buildozer -v android debug
```

**ç¼–è¯‘è¿‡ç¨‹**ï¼š
1. ä¸‹è½½Android SDK
2. ä¸‹è½½Android NDK
3. ä¸‹è½½Python-for-android
4. ç¼–è¯‘Pythonä¾èµ–
5. æ‰“åŒ…APK

**é¢„è®¡æ—¶é—´**ï¼š
- é¦–æ¬¡ç¼–è¯‘ï¼š1-2å°æ—¶
- åç»­ç¼–è¯‘ï¼š5-10åˆ†é’Ÿ

#### 4.3 æŸ¥çœ‹ç¼–è¯‘ç»“æœ

```bash
# APKä½ç½®
ls -lh bin/*.apk

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
# dualvideoplayer-1.4.2-arm64-v8a-debug.apk
```

---

### ç¬¬äº”æ­¥ï¼šå®‰è£…åˆ°æ‰‹æœº

#### 5.1 å¯ç”¨USBè°ƒè¯•

åœ¨Xiaomi 15 Ultraä¸Šï¼š
1. è®¾ç½® â†’ æˆ‘çš„è®¾å¤‡ â†’ å…¨éƒ¨å‚æ•°
2. è¿ç»­ç‚¹å‡»"MIUIç‰ˆæœ¬"7æ¬¡ï¼Œå¯ç”¨å¼€å‘è€…é€‰é¡¹
3. è®¾ç½® â†’ æ›´å¤šè®¾ç½® â†’ å¼€å‘è€…é€‰é¡¹
4. å¯ç”¨"USBè°ƒè¯•"

#### 5.2 è¿æ¥æ‰‹æœº

```bash
# åœ¨WSLä¸­å®‰è£…adb
sudo apt install -y android-tools-adb

# è¿æ¥æ‰‹æœºåæ£€æŸ¥
adb devices

# åº”è¯¥çœ‹åˆ°è®¾å¤‡åˆ—è¡¨
```

**å¦‚æœçœ‹ä¸åˆ°è®¾å¤‡**ï¼š
- æ£€æŸ¥USBè¿æ¥
- åœ¨æ‰‹æœºä¸Šå…è®¸USBè°ƒè¯•
- å°è¯•ï¼š`adb kill-server && adb start-server`

#### 5.3 å®‰è£…APK

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨buildozer
buildozer android deploy run

# æ–¹æ³•2ï¼šæ‰‹åŠ¨å®‰è£…
adb install -r bin/*.apk

# æ–¹æ³•3ï¼šå¤åˆ¶åˆ°Windowsåæ‰‹åŠ¨å®‰è£…
cp bin/*.apk /mnt/d/
```

---

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šBuildozerä¸‹è½½å¤±è´¥

**ç—‡çŠ¶**ï¼šä¸‹è½½Android SDK/NDKè¶…æ—¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# è®¾ç½®é•œåƒæº
export ANDROID_SDK_HOME=~/.buildozer/android/platform/android-sdk
export ANDROID_NDK_HOME=~/.buildozer/android/platform/android-ndk

# æˆ–æ‰‹åŠ¨ä¸‹è½½åæ”¾ç½®åˆ°å¯¹åº”ç›®å½•
```

### é—®é¢˜2ï¼šç¼–è¯‘å¤±è´¥ - Cythonç‰ˆæœ¬

**ç—‡çŠ¶**ï¼š`Cython version mismatch`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
pip3 uninstall cython
pip3 install cython==0.29.33
```

### é—®é¢˜3ï¼šå†…å­˜ä¸è¶³

**ç—‡çŠ¶**ï¼šç¼–è¯‘è¿‡ç¨‹ä¸­å¡æ­»

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å¢åŠ WSLå†…å­˜é™åˆ¶
# åœ¨Windowsç”¨æˆ·ç›®å½•åˆ›å»º .wslconfig æ–‡ä»¶
# C:\Users\ä½ çš„ç”¨æˆ·å\.wslconfig

[wsl2]
memory=8GB
processors=4
```

### é—®é¢˜4ï¼šæƒé™é—®é¢˜

**ç—‡çŠ¶**ï¼š`Permission denied`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä¿®å¤æƒé™
chmod +x buildozer.spec
chmod -R 755 .buildozer
```

### é—®é¢˜5ï¼šJavaç‰ˆæœ¬é—®é¢˜

**ç—‡çŠ¶**ï¼š`Java version not supported`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å®‰è£…æ­£ç¡®çš„Javaç‰ˆæœ¬
sudo apt install openjdk-17-jdk

# è®¾ç½®é»˜è®¤Java
sudo update-alternatives --config java
```

---

## ğŸ“Š ç¼–è¯‘æ—¶é—´å‚è€ƒ

### é¦–æ¬¡ç¼–è¯‘

| æ­¥éª¤ | é¢„è®¡æ—¶é—´ |
|------|---------|
| ä¸‹è½½SDK/NDK | 30-60åˆ†é’Ÿ |
| ç¼–è¯‘Python | 20-30åˆ†é’Ÿ |
| ç¼–è¯‘ä¾èµ– | 10-20åˆ†é’Ÿ |
| æ‰“åŒ…APK | 5-10åˆ†é’Ÿ |
| **æ€»è®¡** | **1-2å°æ—¶** |

### åç»­ç¼–è¯‘

| æ­¥éª¤ | é¢„è®¡æ—¶é—´ |
|------|---------|
| æ£€æŸ¥ä¾èµ– | 1-2åˆ†é’Ÿ |
| ç¼–è¯‘ä»£ç  | 2-3åˆ†é’Ÿ |
| æ‰“åŒ…APK | 2-3åˆ†é’Ÿ |
| **æ€»è®¡** | **5-10åˆ†é’Ÿ** |

---

## ğŸš€ å¿«é€Ÿç¼–è¯‘è„šæœ¬

åˆ›å»ºç¼–è¯‘è„šæœ¬ `build.sh`ï¼š

```bash
#!/bin/bash

echo "========================================="
echo "  åŒè§†é¢‘æ’­æ”¾å™¨ Android ç¼–è¯‘è„šæœ¬"
echo "========================================="
echo ""

# æ£€æŸ¥ç¯å¢ƒ
echo "[1/4] æ£€æŸ¥ç¼–è¯‘ç¯å¢ƒ..."
if ! command -v buildozer &> /dev/null; then
    echo "é”™è¯¯ï¼šBuildozeræœªå®‰è£…"
    exit 1
fi

# æ¸…ç†æ—§æ–‡ä»¶
echo "[2/4] æ¸…ç†æ—§æ–‡ä»¶..."
rm -rf bin/*.apk

# ç¼–è¯‘APK
echo "[3/4] å¼€å§‹ç¼–è¯‘..."
buildozer -v android debug

# æ£€æŸ¥ç»“æœ
echo "[4/4] æ£€æŸ¥ç¼–è¯‘ç»“æœ..."
if [ -f bin/*.apk ]; then
    echo ""
    echo "========================================="
    echo "  ç¼–è¯‘æˆåŠŸï¼"
    echo "========================================="
    ls -lh bin/*.apk
    echo ""
    echo "å®‰è£…å‘½ä»¤ï¼š"
    echo "  adb install -r bin/*.apk"
    echo ""
else
    echo ""
    echo "========================================="
    echo "  ç¼–è¯‘å¤±è´¥ï¼"
    echo "========================================="
    echo "è¯·æŸ¥çœ‹ä¸Šæ–¹é”™è¯¯ä¿¡æ¯"
    echo ""
    exit 1
fi
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
chmod +x build.sh
./build.sh
```

---

## ğŸ“± æµ‹è¯•æ¸…å•

ç¼–è¯‘å®Œæˆåï¼Œåœ¨æ‰‹æœºä¸Šæµ‹è¯•ï¼š

### åŸºç¡€åŠŸèƒ½
- [ ] åº”ç”¨æ­£å¸¸å¯åŠ¨
- [ ] ç•Œé¢æ˜¾ç¤ºæ­£å¸¸
- [ ] æŒ‰é’®å¯ä»¥ç‚¹å‡»

### è§†é¢‘åŠ è½½
- [ ] å¯ä»¥æ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨
- [ ] å¯ä»¥é€‰æ‹©è§†é¢‘æ–‡ä»¶
- [ ] è§†é¢‘1åŠ è½½æˆåŠŸ
- [ ] è§†é¢‘2åŠ è½½æˆåŠŸ

### æ’­æ”¾æ§åˆ¶
- [ ] æ’­æ”¾æŒ‰é’®æ­£å¸¸
- [ ] æš‚åœæŒ‰é’®æ­£å¸¸
- [ ] åœæ­¢æŒ‰é’®æ­£å¸¸
- [ ] è¿›åº¦æ¡å¯æ‹–åŠ¨

### å¸§æ§åˆ¶
- [ ] å‰è¿›æŒ‰é’®æ­£å¸¸
- [ ] åé€€æŒ‰é’®æ­£å¸¸
- [ ] æ­¥è¿›å€¼å¯é€‰æ‹©
- [ ] é”®ç›˜æ–¹å‘é”®æœ‰æ•ˆ

### é€Ÿåº¦æ§åˆ¶
- [ ] é€Ÿåº¦é€‰æ‹©å™¨æ­£å¸¸
- [ ] é€Ÿåº¦å˜åŒ–ç”Ÿæ•ˆ
- [ ] è§†é¢‘é€‰æ‹©å™¨æ­£å¸¸

### æ€§èƒ½æµ‹è¯•
- [ ] å•è§†é¢‘æ’­æ”¾æµç•…
- [ ] åŒè§†é¢‘æ’­æ”¾æµç•…
- [ ] å¸§è·³è½¬å“åº”å¿«
- [ ] æ— æ˜æ˜¾å¡é¡¿

---

## ğŸ“ å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£
- Kivy: https://kivy.org/doc/stable/
- Buildozer: https://buildozer.readthedocs.io/
- Python-for-android: https://python-for-android.readthedocs.io/

### è§†é¢‘æ•™ç¨‹
- Kivyå…¥é—¨: https://www.youtube.com/results?search_query=kivy+tutorial
- Buildozerä½¿ç”¨: https://www.youtube.com/results?search_query=buildozer+tutorial

### ç¤¾åŒºæ”¯æŒ
- Kivy Discord: https://chat.kivy.org/
- Stack Overflow: æœç´¢ `kivy` æˆ– `buildozer`

---

## ğŸ’¡ ä¼˜åŒ–å»ºè®®

### åŠ é€Ÿç¼–è¯‘

1. **ä½¿ç”¨ccache**ï¼š
```bash
sudo apt install ccache
export USE_CCACHE=1
```

2. **å¢åŠ å¹¶è¡Œç¼–è¯‘**ï¼š
åœ¨ `buildozer.spec` ä¸­æ·»åŠ ï¼š
```ini
android.gradle_dependencies = 
android.enable_androidx = True
```

3. **ä½¿ç”¨æœ¬åœ°ç¼“å­˜**ï¼š
ä¿ç•™ `.buildozer` ç›®å½•ï¼Œé¿å…é‡å¤ä¸‹è½½

### å‡å°APKå¤§å°

1. **ç§»é™¤æœªä½¿ç”¨çš„æ¶æ„**ï¼š
```ini
android.archs = arm64-v8a
```

2. **å¯ç”¨ProGuard**ï¼ˆReleaseç‰ˆæœ¬ï¼‰ï¼š
```ini
android.release_artifact = apk
```

---

**ç¼–è¯‘æŒ‡å—ç‰ˆæœ¬**: 1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-10-29  
**é€‚ç”¨ç‰ˆæœ¬**: åŒè§†é¢‘æ’­æ”¾å™¨ v1.4.2 Android
